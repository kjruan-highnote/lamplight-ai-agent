<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mermaid Validation Test</title>
    
    <!-- Mermaid v11.9.0 specifically -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@11.9.0/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            sequence: {
                showSequenceNumbers: true
            }
        });
    </script>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            padding: 20px;
        }
        .mermaid {
            text-align: center;
            margin: 20px 0;
            background: #f6f8fa;
            padding: 20px;
            border-radius: 6px;
        }
        .test-case {
            border: 2px solid #0969da;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        .test-case h2 {
            color: #0969da;
            margin-top: 0;
        }
        .status {
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background: #d1f3d1; color: #0a5d0a; }
        .error { background: #fdd; color: #d00; }
    </style>
</head>
<body>
    <h1>Mermaid v11.9.0 Validation Tests</h1>
    <p>Testing the exact Mermaid syntax generated by our solution generator.</p>

    <div class="test-case">
        <h2>Test 1: Initial Setup Workflow</h2>
        <p>This is the exact syntax from our generated HTML:</p>
        <div class="mermaid">
sequenceDiagram
    autonumber
    title Initial Setup

    participant CUSTOMER as trip com
    participant VENDOR as Highnote

    Note over CUSTOMER: One-time setup for new organizations

    CUSTOMER->>+VENDOR: CreateSecretApiKey [Required]
    Note right of VENDOR: Create API credentials...
    VENDOR-->>-CUSTOMER: Created (201)

    CUSTOMER->>+VENDOR: CreateCardProduct [Required]
    Note right of VENDOR: Setup card product...
    VENDOR-->>-CUSTOMER: Created (201)

    CUSTOMER->>+VENDOR: CreateCardProductWithTemplate
    Note right of VENDOR: Alternative setup with template...
    VENDOR-->>-CUSTOMER: Created (201)


    Note over CUSTOMER,VENDOR: Workflow Complete
        </div>
        <p class="status success" id="status1">Checking render status...</p>
    </div>

    <div class="test-case">
        <h2>Test 2: Transaction Processing with Multiple Participants</h2>
        <p>Complex workflow with AUTH, WEBHOOK, and PAYMENT participants:</p>
        <div class="mermaid">
sequenceDiagram
    autonumber
    title Transaction Processing

    participant CUSTOMER as trip com
    participant VENDOR as Highnote
    participant WEBHOOK as Webhook Service
    participant AUTH as Auth Service
    participant PAYMENT as Payment Processor

    Note over CUSTOMER: Process card transactions

    alt sandbox only
        CUSTOMER->>+VENDOR: SimulateAuthorization
        VENDOR-->>-CUSTOMER: Simulation Complete
    end

    alt sandbox only
        CUSTOMER->>+VENDOR: SimulateClearing
        VENDOR-->>-CUSTOMER: Simulation Complete
    end

    CUSTOMER->>+WEBHOOK: GetTransactionEvent [Required]
    WEBHOOK-->>-CUSTOMER: Data Response (200)

    CUSTOMER->>+WEBHOOK: TransactionEventsByPaymentCardAndTransactionId [Required]
    WEBHOOK-->>-CUSTOMER: Success (200)


    Note over CUSTOMER,VENDOR: Workflow Complete
        </div>
        <p class="status success" id="status2">Checking render status...</p>
    </div>

    <div class="test-case">
        <h2>Test 3: Card Lifecycle Management</h2>
        <p>Testing PAYMENT participant interactions:</p>
        <div class="mermaid">
sequenceDiagram
    autonumber
    title Card Lifecycle Management

    participant CUSTOMER as trip com
    participant VENDOR as Highnote
    participant PAYMENT as Payment Processor

    Note over CUSTOMER: Manage card states

    CUSTOMER->>+PAYMENT: ActivatePaymentCard [Required]
    PAYMENT-->>-CUSTOMER: Activated (200)

    CUSTOMER->>+PAYMENT: SuspendPaymentCard [Required]
    PAYMENT-->>-CUSTOMER: Suspended (200)

    CUSTOMER->>+PAYMENT: ClosePaymentCard [Required]
    PAYMENT-->>-CUSTOMER: Success (200)


    Note over CUSTOMER,VENDOR: Workflow Complete
        </div>
        <p class="status success" id="status3">Checking render status...</p>
    </div>

    <script>
        // Check if Mermaid diagrams rendered successfully
        window.addEventListener('load', function() {
            setTimeout(function() {
                const mermaidDivs = document.querySelectorAll('.mermaid');
                mermaidDivs.forEach((div, index) => {
                    const statusEl = document.getElementById(`status${index + 1}`);
                    const svg = div.querySelector('svg');
                    if (svg) {
                        statusEl.textContent = '✅ Diagram rendered successfully!';
                        statusEl.className = 'status success';
                    } else {
                        statusEl.textContent = '❌ Diagram failed to render';
                        statusEl.className = 'status error';
                        // Log any text content that might indicate an error
                        console.error(`Diagram ${index + 1} content:`, div.textContent);
                    }
                });
            }, 1000); // Give Mermaid time to render
        });
    </script>
</body>
</html>